{"properties":{},"description":"","processes":{"python3operator1":{"component":"com.sap.system.python3Operator","metadata":{"label":"Python3Operator","x":12,"y":81,"height":80,"width":120,"extensible":true,"config":{"script":"import pandas as pd\nfrom io import BytesIO\n\ndef on_input(data):\n    # Acquire Data as Bytes\n    dataio = BytesIO(data)\n    # Load data into Pandas Data Frame, skipping 5 rows\n    df = pd.read_table(dataio, sep=',',skiprows=5, encoding='latin1', names=['ER_DATE','EXCHANGE_RATE'])\n    # Replace the \"-\" characters with Null\n    df['EXCHANGE_RATE'].replace('-', None, inplace=True)\n    df = df.to_csv(index=False,header=False)\n    \n    # Create a DH Message - Data Hub api.Message\n    attr = dict()\n    attr[\"message.commit.token\"] = \"stop-token\"\n    messageout = api.Message(body=df, attributes=attr)\n    api.send(\"outmsg\", messageout)\n\napi.set_port_callback(\"input\", on_input)"},"additionalinports":[{"name":"input","type":"blob"}],"additionaloutports":[{"name":"outmsg","type":"message"}]}},"httpclient1":{"component":"com.sap.http.client","metadata":{"label":"HTTP Client","x":-241,"y":41,"height":80,"width":120,"config":{"getUrl":"http://sdw.ecb.europa.eu/quickviewexport.do?SERIES_KEY=120.EXR.D.USD.EUR.SP00.A&type.csv","requestTimeoutInMs":5000,"getPeriodInMs":30000}}},"wiretap1":{"component":"com.sap.util.wiretap","metadata":{"label":"Wiretap","x":473,"y":-39,"height":80,"width":120,"ui":"dynpath","config":{}}},"hdfsproducer1":{"component":"com.sap.storage.hdfs.producer","metadata":{"label":"HDFS Producer","x":473,"y":81,"height":80,"width":120,"config":{"hadoopNamenode":"spark-hdfs-adapter:8020","path":"/WebData/ECB/ecb-usd-eur-v2-<date>-<time>.csv"}}},"13multiplexer1":{"component":"com.sap.system.multiplexer.1-3","metadata":{"label":"1:3 Multiplexer","x":237,"y":81,"height":80,"width":120,"extensible":true,"config":{}}},"voraavroingestor1":{"component":"com.sap.vora.avroingestor","metadata":{"label":"Vora Avro Ingestor","x":477,"y":209,"height":80,"width":120,"config":{"databaseSchema":"WEBDATA","dsn":"v2://dqp:50000/?binary=true","tableType":"","format":"csv","defaultAvroSchema":"{   \"name\": \"ECB_EXCHANGE_RATE_V2\",   \"type\": \"record\",   \"fields\": [     {       \"name\": \"ER_DATE\",       \"type\": [         \"null\",         \"date\"       ]     },     {       \"name\": \"EXCHANGE_RATE\",       \"type\": [         \"null\",         \"double\"       ]     }   ] }","user":"admin","password":"voraadmin"}}},"graphterminator1":{"component":"com.sap.util.graphTerminator","metadata":{"label":"Graph Terminator","x":662,"y":209,"height":80,"width":120,"config":{}}}},"groups":[{"name":"group1","nodes":["python3operator1"],"metadata":{"description":"Group"},"tags":{"python36":"","python_pandas":""}}],"connections":[{"metadata":{"points":"361,103 415,103 415,1 469,1"},"src":{"port":"out1","process":"13multiplexer1"},"tgt":{"port":"in","process":"wiretap1"}},{"metadata":{"points":"361,121 469,121"},"src":{"port":"out2","process":"13multiplexer1"},"tgt":{"port":"inFile","process":"hdfsproducer1"}},{"metadata":{"points":"361,139 417,139 417,249 473,249"},"src":{"port":"out3","process":"13multiplexer1"},"tgt":{"port":"in","process":"voraavroingestor1"}},{"metadata":{"points":"601,249 658,249"},"src":{"port":"out","process":"voraavroingestor1"},"tgt":{"port":"stop","process":"graphterminator1"}},{"metadata":{"points":"-117,72 -54.5,72 -54.5,121 8,121"},"src":{"port":"out","process":"httpclient1"},"tgt":{"port":"input","process":"python3operator1"}},{"metadata":{"points":"136,121 233,121"},"src":{"port":"outmsg","process":"python3operator1"},"tgt":{"port":"in1","process":"13multiplexer1"}}],"inports":{},"outports":{}}